<section class='section'>
    <div class='container'>
        <div class='columns'>
            <div class='column'>
                <p class="title is-3 is-spaced">{{topic.topic_name}}</p>
                <p class="subtitle is-5">{{topic.description}}</p>
                {{#if posts}}             
                <article class="panel is-link mt-6">
                    <p class="panel-heading">Chatter</p>
                    {{#each posts as |post|}}
                        <a href="/topic/{{post.topic_id}}/{{post.id}}" class="panel-block">
                            {{!-- <span class="panel-icon">
                                <i class="fa-solid fa-circle-small" aria-hidden="true"></i>
                            </span> --}}
                            {{post.post_name}}
                        </a>
                    {{/each}}
                {{else}}
                <article class="panel is-link mt-6">
                    <p class="panel-heading">Chatter</p>
                        <a class="panel-block">
                            No posts yet
                        </a>
                </article>
                {{/if}}
                </article>

            </div>

            <div class='column is-one-third' style="margin-left: 50px;">
                <h1 class='title is-4 pb-4'>About community</h1>
                <p class='subtitle'><span><i class='fa-duotone fa-users'></i>
                        1,234 Members</span></p>
                <p class='subtitle'><span><i
                            class='fa-solid fa-chart-simple'
                        ></i>
                        ${{format_amount topic.volume}} Total Volume</span></p>
                <p class='subtitle'><span><i
                            class='fa-solid fa-square-dollar'
                        ></i>
                        ${{topic.price}}
                        Per Share (IPO)</span></p>
                <p class='subtitle'><span><i class='fa-solid fa-warehouse'></i>
                        {{topic.initial_shares}}
                        Initial Shares Remaining</span></p>
                <div class='dropdown' id='ipo-buy-dropdown'>
                    <form>
                        <div class='dropdown-trigger'>
                            <button
                                class='button px-6'
                                aria-haspopup='true'
                                aria-controls='dropdown-menu2'
                                id='ipo-buy-dropdown-btn'
                            >
                                <span><b>Purchase IPO</b></span>
                                <span class='icon is-small'>
                                    <i
                                        class='fas fa-angle-down'
                                        aria-hidden='true'
                                    ></i>
                                </span>
                            </button>
                        </div>
                        <div
                            class='dropdown-menu'
                            id='dropdown-menu2'
                            role='menu'
                        >
                            <div class='dropdown-content'>
                                <div class='dropdown-item'>
                                    <p class='py-2'><strong
                                        >Quantity:</strong></p>
                                    <input
                                        type='number'
                                        id='ipo-share-quantity'
                                        {{! ADD MAXIMUM HERE!! }}
                                    />
                                </div>
                                <hr class='dropdown-divider' />
                                <div class='dropdown-item'>
                                    <p><strong>Total Price:</strong>
                                        <span
                                            id='ipo-total-price'
                                            data-price='{{topic.price}}'
                                        >$</span></p>
                                </div>
                                <hr class='dropdown-divider' />
                                <div class='dropdown-item'>
                                    <button
                                        class='button'
                                        id='ipo-confirm-btn'
                                        data-topic_id="{{topic.id}}"
                                    >Confirm</button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="notification is-success is-hidden" id="IPO-notification">
                    
                </div>
                
                <div>
                    <h2 class="title is-4">Orderbook:</h2>
                    <div class="box has-background-success-light">
                        <h2 class="subtitle has-text-centered"><b>Bids</b></h2>

                        <nav class="level py-0 mb-1">
                            <div class="level-left ml-5">
                                <div class="level-item">
                                    <p class="subtitle is-5">
                                        <strong>Price:</strong>
                                    </p>
                                </div>
                            </div>
                            <div class="level-right">
                                <div class="level-item mr-5">
                                    <p class="subtitle is-5">
                                        <strong>Quantity:</strong>
                                    </p>
                                </div>
                            </div>
                        </nav>
                        {{#each bids}}
                            {{>bids}}
                        {{/each}}
                    </div>
                    <div class="box has-background-danger-light">
                        <h2 class="subtitle has-text-centered"><b>Asks</b></h2>

                        {{#each asks}}
                            {{>asks}}
                        {{/each}}
                        <nav class="level py-0 mb-1">
                            <div class="level-left ml-5">
                                <div class="level-item">
                                    <p class="subtitle is-5">
                                        <strong>Price:</strong>
                                    </p>
                                </div>
                            </div>
                            <div class="level-right">
                                <div class="level-item mr-5">
                                    <p class="subtitle is-5">
                                        <strong>Quantity:</strong>
                                    </p>
                                </div>
                            </div>
                        </nav>
                    </div>
                </div>

            </div>
        </div>
    </div>
</section>
<section class=''>
    <div class='container'>
        <div class='columns'>
            
            <div class='column'>
                {{!-- <article class="panel is-link mt-6">
                    <p class="panel-heading">Chatter</p>
                    {{#each posts as |post|}}
                        <a class="panel-block">
                            <span class="panel-icon">
                            <i class="fa-sharp fa-solid fa-plus" aria-hidden="true"></i>
                            </span>
                            {{post.post_name}}
                        </a>
                    {{/each}}
                </article> --}}
            </div>
            <div class='column is-one-third'>
             <form id="new_post_form">
      <div class="field">
      <h1 class='title is-4'>Say something</h1>
        <div class="control">
          <input class="input" type="text" placeholder="Title" id="post_name">
        </div>
      </div>
      <div class="field">
        <div class="control">
          <textarea class="textarea" placeholder="Text" id="post_contents"></textarea>
        </div>
      </div>
      <div class="field is-grouped">
      <div class="control">
        <button type="submit" value="Submit" class="button is-link">Submit</button>
      </div>
      </div>
    </form>
            </div>
        </div>
    </div>
</section>

<script src='../js/topic-details.js'></script>
<script src='../js/post.js'></script>


{{!-- <a href='http://localhost:3001/topic'>Back to all topics</a>
<br /><br />
<div>
    {{! Topic details }}
    <h1>{{topic.topic_name}}</h1>
    <p>About: {{topic.description}}</p>
    <p>Current price: <span>{{topic.price}}</span></p>
    <p>Total shares: <span>{{topic.total_shares}}</span></p>
</div>

<a href='http://localhost:3001/topic/edit/{{topic.id}}'><button
        type='submit'
        value='Submit'
    >Edit this topic</button></a>
<button id='delete-topic' type='submit' value='Submit'>Delete this topic</button>

<h2>Posts</h2>
<a href='http://localhost:3001/topic/{{topic.id}}/post/new'>Create a post</a>

<hr />

<button id='buy'>Buy IPO</button> --}}

{{! <script>

    const id = window.location.toString().split('/')[
    window.location.toString().split('/').length - 1 ]; async function
    deleteTopicHandler(event) { const response = await fetch(`/api/topic/${id}`,
    { method: 'DELETE', }); if (response.ok) {
    document.location.replace('/topic'); } else { alert('Failed to delete
    topic'); } }; document .querySelector("#delete-topic")
    .addEventListener("click", deleteTopicHandler)
</script> }}